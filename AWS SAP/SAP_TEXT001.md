# SAP#01
## 0101
>Q. 転送中および保存時に暗号化する必要のある数千の100GBファイルにわたる数百万の機密トランザクションを保持。
>- 転送中と保存時に暗号化される必要がある。
>- ビジネス上の意思決定の舵取りに使用できるシュミレーションを生成するため最大5TBのスペースを消費するファイルのサブセットに依存。
>- 長期ストレージとデータの処理中のサブセットに費用対効果の高い方法で対応できる設計とは。 

- 大容量のファイルをやりとりするとき暗号化する必要がある。
- シュミレーションを生成するために5TBのスペースを消費する。

>A. サーバー側の暗号化でAmazon S3を使用し、HTTPSを使用して転送し、Amazon EC2のエフェメラルドライブのサブセットでシュミレーションを実行する。

- エフェメラルドライブ：揮発性ドライブ。インスタンス停止でデータが消去される。一時ファイルを格納するために使うストレージ。
- 5TBのデータを使用したシュミレーションはメモリ内では実行不可
- Amazon EMR (旧称 Amazon Elastic MapReduce) ：ビッグデータを処理および分析するマネージドクラスタープラットフォーム
- HDFS：マスターノードおよびコアノードによって使用。利点は高速である。欠点は、エフェメラルなストレージであり、クラスターが終了すると回収される。最適な用途は、ジョブフローの中間ステップで得られた結果のキャッシュ場所です。
- EBSの利用：コストが高い

### S3とHDFSの違い
- 違い１：S3 は HDFS よりもスケーラブルである
- 違い２：S3 は HDFS より耐久性がある
- 違い３：S3 のデータは、HDFSのデータとは異なり、常に永続的である
- 違い４：S3 は費用対効果が高く、HDFS よりも安い可能性が高い
- 違い５：パフォーマンスに関しては HDFS が優れており、S3 を上回っている


## 0102
>Q. すべてのEC2に追加の保護層を提供する方法は？

>A
> - すべてのEC2リソースを識別するために、適切なタグ付け戦略が実装されていることを確認する
> - EC2インスタンスへのリクエストが特定のIPアドレスまたはCIDRブロック範囲からのものであることを指定するポリシーにIPアドレスの条件を追加する
> - タグ付けしたリソースに対してアクセス許可を拒否または許可するポリシーを追加する

- IAMアイデンティティベースのポリシー
    - 最初のレイヤーはルートテーブルです。ルートテーブルではゲートウェイを制御します。
    - サブネット自体でインバウンドとアウトバウンド両方の拒否ポリシーを設定できます。
    - https://qiita.com/hasmukhrathod_nttdintellilink/items/fa552a0446bbfb277d45

## 0103
- ヒューリスティック
    - 必ず正しい答えが導けるわけではないが、ある程度のレベルで正解に近い解を得ることができる方法
- Amazon Kinesis (Data Streams)
    - デフォルトの保存期間はで24時間。

## 0104
- IAM
    - https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/best-practices.html

## 0105
- 一括請求
    - AWS Organizationの一括請求
    - https://docs.aws.amazon.com/ja_jp/awsaccountbilling/latest/aboutv2/consolidated-billing.html
- クロスアカウントアクセス
    - アカウントA (123423453456) に加えてアカウントB (654354324321) のリソースを管理すると管理すべきログイン情報が増える。
    - クロスアカウントアクセスの出番です! クロスアカウントアクセスを使うと、「アカウントAのプリンシパル」から「アカウントBのリソース」を操作できる

## 0106
- IDフェデレーション
    - 「ユーザー認証」と「リソースアクセス承認のために必要な情報伝達」を目的とした2者間の信頼連携システム.
    - それぞれ独自のID管理システムを持つ複数のセキュリティドメイン間で、それぞれのユーザーIDをリンクさせる
- AD Connector
    - AWS管理コンソールのユーザとパスワードをオンプレのADと連携する
    - 既存のオンプレミス Microsoft Active Directory を使用して、AWS のアプリケーションやサービスにアクセス情報をキャッシュせずにオンプレミスの Microsoft Active Directory へリダイレクトするのに使用するディレクトリゲートウェイ

## 0107
- 数万ユーザ利用の写真共有サービス（モバイル）
    - S3バケット内のすべてのユーザオブジェクトにユーザIDで設定されるキーベースの命名方式を採用
    - アプリケーションレベルでユーザを認証し、AWS Security Token Service(STS)を使用して、S3オブジェクトにトークンベースの認証を付与

## 0301
- Amazon Elastic MapReduce(EMR)
    - ログデータをS3に収集し、Amazon Elastic MapReduce(EMR)ジョブに処理し、Amazon Redshiftデータウェアハウス用のCSVおよび日別レポートを生成する。
    - Amazon EMR (旧称 Amazon Elastic MapReduce) は、AWS でビッグデータフレームワーク (Apache Hadoop や Apache Spark など) の実行を簡素化して、ビッグデータを処理および分析するマネージドクラスタープラットフォーム
    - マスターはリザーブやオンデマンド、ジョブはスポットなどが費用対効果が高い
- S3 1ゾーン -IA
    - Amazon S3 One Zone-Infrequent Access (S3 One Zone-IA)
    - アクセス頻度は低いが、必要に応じてすぐに取り出すことが必要なデータに適している
    - データ損失の影響を受けやすい可能性
- アプリケーション向けのインスタンスの構成シナリオ
    - データウェアハウス：マスターノードはオンデマンド。コアノードはオンデマンド/インスタンスフリートの組合せ。タスクノードはスポット/インスタンスフリートの組合せ
- インスタンスフリート
    - 10台サーバが必要な際は2割オンデマンド・8割スポットとかの設定
- S3ストレージクラスについて
    - https://aws.amazon.com/jp/s3/storage-classes/

